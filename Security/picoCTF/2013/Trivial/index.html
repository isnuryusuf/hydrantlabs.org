<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css" rel="stylesheet">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link href="/assets/css/screen.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="//use.typekit.net/xkx0oup.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){};</script>
    <title>Trivial (45) Solution picoCTF 2013 | Hydrant Labs</title>
  </head>
  <body onload="prettyPrint()">
    <div class="main-container">
      <div class="navbar navbar-default navbar-main">
        <div class="container">
          <div class="navbar-header">
            <div type="button" data-toggle="collapse" data-target=".navbar-collapse" class="button navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></div><a href="#" class="navbar-brand"><img src="/assets/images/logo.png" class="logo"><span class="mix-green">Hydrant </span><span class="mix-gray">Labs</span></a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/index.html" class="mix-gray">Home</a></li>
              <li><a href="/Projects/index.html" class="mix-gray">Projects</a></li>
              <li><a href="/Security/index.html" class="mix-gray">Security</a></li>
              <li><a href="/Contact/index.html" class="mix-gray">Contact</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="container"><h1 id="picoctf-2013-trivial-45-">picoCTF 2013: Trivial (45)</h1>
<hr>
<h2 id="challenge-">Challenge:</h2>
<p>An unlocked terminal is displaying the following:</p>
<pre>Encryption complete, ENC(???,T0pS3cre7key) = Bot kmws mikferuigmzf rmfrxrwqe abs perudsf! Nvm kda ut ab8bv_w4ue0_ab8v_DDU
</pre><p>You poke around and find this interesting <a href="assets/encrypt.py">file</a>.</p>
<h2 id="solution-">Solution:</h2>
<p>Examining the encryption python script I wrote a decryption node.js script:</p>
<pre class="prettyprint lang-js">// Get the key
var key = process.argv[2];

// Get the cipherText
var cipherText = process.argv[3].split(&quot;&quot;);

// From encrypt.py
var keyChars = &quot;0123456789abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;

// Final plainText
var plainText = &quot;&quot;;

// Fix mod
Number.prototype.mod = function(n) { return ((this%n)+n)%n; };

// Get the ord for the char
function ord(char) { return char.charCodeAt(0); }

// If a char is in the range between lower and upper chars
function charInRange(char, lower, upper) { return (keyChars.indexOf(char) &gt;= keyChars.indexOf(lower)) &amp;&amp; (keyChars.indexOf(char) &lt;= keyChars.indexOf(upper)); }

// Loop each cipherText char
for (var i in cipherText) {

 // Calculate the rotate amount
 var rotate_amount = keyChars.indexOf(key[i%key.length]);

 // Get the charCode
 var charCode = ord(cipherText[i]);

 // Lowercase
 if (charInRange(cipherText[i], &quot;a&quot;, &quot;z&quot;)) {

  // Update
  charCode = ord(&quot;a&quot;) + (charCode - ord(&quot;a&quot;) - rotate_amount).mod(26);

 // Uppercase
 } else if (charInRange(cipherText[i], &quot;A&quot;, &quot;Z&quot;)) {

  // Update
  charCode = ord(&quot;A&quot;) + (charCode - ord(&quot;A&quot;) - rotate_amount).mod(26);

 // Numbers
 } else if (charInRange(cipherText[i], &quot;0&quot;, &quot;9&quot;)) {

  // Update
  charCode = ord(&quot;0&quot;) + (((charCode - ord(&quot;0&quot;) - rotate_amount).mod(10)));

 }

 // Add the plain text
 plainText += String.fromCharCode(charCode);

}

// Print the plain text
console.log(plainText);
</pre>
<p>Run via the following:</p>
<pre class="prettyprint lang-shell">node decrypt.js &quot;T0pS3cre7key&quot; &quot;Bot kmws mikferuigmzf rmfrxrwqe abs perudsf\! Nvm kda ut ab8bv_w4ue0_ab8v_DDU&quot;
</pre>
<p>This results in our output:</p>
<pre>You have successfully decrypted the message! The key is th4ts_x0rs3_th4n_DES
</pre><p>This means our final key is:</p>
<pre>th4ts_x0rs3_th4n_DES
</pre>
      </div>
      <div class="footer-space"></div>
      <div class="footer">
        <div class="container">
          <p class="muted credit"><span>&copy; 2013 Luke Young. All rights reserved.</span><span class="footer-divider">|</span><span>This site is proudly hosted on <a href="https://digitalocean.com/">Digital Ocean</a>.</span><span class="footer-divider">|</span><span>Site designed, built, and maintained by <a href="http://hydrantlabs.com">Luke Young</a>.</span></p>
        </div>
      </div>
    </div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-44361710-1', 'hydrantlabs.org');
      ga('send', 'pageview');
    </script>
  </body>
</html>