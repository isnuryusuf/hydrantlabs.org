<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css" rel="stylesheet">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link href="/assets/css/screen.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="//use.typekit.net/xkx0oup.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){};</script>
    <title>Try Them All! (45) Solution picoCTF 2013 | Hydrant Labs</title>
  </head>
  <body onload="prettyPrint()">
    <div class="main-container">
      <div class="navbar navbar-default navbar-main">
        <div class="container">
          <div class="navbar-header">
            <div type="button" data-toggle="collapse" data-target=".navbar-collapse" class="button navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></div><a href="#" class="navbar-brand"><img src="/assets/images/logo.png" class="logo"><span class="mix-green">Hydrant </span><span class="mix-gray">Labs</span></a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/index.html" class="mix-gray">Home</a></li>
              <li><a href="/Projects/index.html" class="mix-gray">Projects</a></li>
              <li><a href="/Security/index.html" class="mix-gray">Security</a></li>
              <li><a href="/Contact/index.html" class="mix-gray">Contact</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="container"><h1 id="picoctf-2013-try-them-all-45-">picoCTF 2013: Try Them All! (45)</h1>
<hr>
<h2 id="challenge-">Challenge:</h2>
<p>You have found a passwd file containing salted passwords. An unprotected configuration file has revealed a salt of 3367. The hashed password for the &#39;admin&#39; user appears to be d6f73940a13ac6ebf07f3abbfc715fef, try to brute force this password.</p>
<h2 id="solution-">Solution:</h2>
<p>I wrote a quick node.js script to just use the default word dictionary, add the salt and calculate the md5sum. If the result matches the desired word, it prints the result. Here it is:</p>
<pre class="prettyprint lang-js">// Use fs for reading the file list
var fs = require(&quot;fs&quot;);

// Use crypto for md5
var crypto = require(&#39;crypto&#39;);

// Read the words
var words = (fs.readFileSync(&quot;/usr/share/dict/words&quot;) + &quot;&quot;).split(&quot;\n&quot;);

// Loop each word
for (i in words) {

 // Get the word
 var word = words[i];

 // Get the md5 of that string plus the salt
 var md5sum = crypto.createHash(&quot;md5&quot;).update(word + &quot;3367&quot;).digest(&quot;hex&quot;);

 // If the md5 matches
 if (md5sum === &quot;d6f73940a13ac6ebf07f3abbfc715fef&quot;) {

  // Print the word that matches
  console.log(word);

 }

}
</pre>
<p>This results in the matching word and subsequently the key:</p>
<pre>comb
</pre>
      </div>
      <div class="footer-space"></div>
      <div class="footer">
        <div class="container">
          <p class="muted credit"><span>&copy; 2013 Luke Young. All rights reserved.</span><span class="footer-divider">|</span><span>This site is proudly hosted on <a href="https://digitalocean.com/">Digital Ocean</a>.</span><span class="footer-divider">|</span><span>Site designed, built, and maintained by <a href="http://hydrantlabs.com">Luke Young</a>.</span></p>
        </div>
      </div>
    </div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-44361710-1', 'hydrantlabs.org');
      ga('send', 'pageview');
    </script>
  </body>
</html>